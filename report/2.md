# 轮式机器人报告二
## 1. A-STAR
* **Dijkstra**
Dijkstra 算法是一个基于「贪心」、「广度优先搜索」、「动态规划」求一个图中一个点到其他所有点的最短路径的算法，时间复杂度$O(n^2)$
每次从「未求出最短路径的点」中取出距离距离起点最小路径的点，以这个点为桥梁刷新「未求出最短路径的点」的距离。
* **Dijkstra到A**
  * 我们需要两个列表 (Open和Closed列表)：一个记录下所有被考虑来寻找最短路径的格子（open列表）一个记录下不会再被考虑的格子（closed列表）
  * 首先在closed列表中添加当前位置（我们把这个开始点称为点 “A”）。然后，把所有与它当前位置相邻的可通行格子添加到open列表中。
  * 在寻路过程中，角色总是不停从一个格子移动到另一个相邻的格子，如果单纯从距离上讲，移动到与自身斜对角的格子走的距离要长一些，而移动到与自身水平或垂直方面平行的格子，则要近一些。每水平或垂直方向移动相邻一个节点所花的代价记为1，则相邻对角节点的代码为1.414(即2的平方根--勾股定理)
  * 用f,g,h来表示寻路过程中的代价。g代表(从起始节点到相邻)节点本身的代价，不需要每到一个节点都从头算一次，而是在上一个节点的g的基础上加1或是1.414，这里的步骤和Dijkstra相似。h代表从指定节点到目标节点（根据不同的估价公式--后面会解释估价公式）估算出来的代价。而 f = g + h 表示节点的总代价
  相比于Dijkstra算法，A-star在选择下一个目标点的时候不是随即选择的而是向某个特定的方向选择，所以会比Dijkstra更快找到目标点。
* **代价函数**
路径通常不止一条，只不过所花的代价不同而已。所以我们要做的事情，就是要尽最大努力找一条代价最小的路径。但是，即使是代价相同的最佳路径，也有可能出现不同的走法。用代码估算起点与终点之间的代价也有不同的方式可以根据机器人的需要来进行选择。
![图片](/home/gaga/Pictures/1.jpg)
如上图，“曼哈顿算法”：笔直的走，然后转个弯，再笔直的继续。“几何算法”的最好解释就是“勾股定理”，算出起点与终点之间的直线距离，然后乘上代价因子。“对角算法”综合了以上二种算法，先按对角线走，一直走到与终点水平或垂直平行后，再笔直的走。
* **相关细节**
  * 栅格化
    利用传进来的地图大小，转化为栅格，将起点、终点、障碍物坐标都转化为栅格的坐标。
  * 判断是否超出地图：每次准备探索下一个节点的时候对其进行判断是否超过界限。
## 2. RRT与RRT*
* **RRT**
  * 从起点开始生长树。
  * 在给定的地图中，生成一个随机点。
  * 在树上找到距离随机点最近的那个点，从上面引出树枝。 
  * 如果没有碰到障碍物就把生长后的树枝和端点添加到树上，返回第2步。 
　　随机点一般是均匀分布的，所以没有障碍物时树会近似均匀地向各个方向生长，这样可以快速探索空间。当然如果你事先掌握了最有可能发现路径的区域信息，可以集中兵力重点探索这个区域，这时就不宜用均匀分布了。在实验中，我们采用了50%的概率朝向目标点生长，50%随机生长。 
　　RRT 的一个弱点是难以在有狭窄通道的环境找到路径。因为狭窄通道面积小，被碰到的概率低，有时候会出现被一直困在障碍物里面的情况。
* **RRT到RRT***
RRT* 在RRT基础上做了改进，主要是进行了重新选择父节点和重布线的操作。在RRT中，采样点最终与整棵树上和它最近的点连了起来，但这未必是最好的选择，我们的最终目的是让这个点与起点的距离尽可能近。RRT*便对此做了改进，它在采样点加入路径树以后，以其为圆心画了一个小圈，考虑是否有更好的父节点，连到那些节点上能使起点到该点的距离更短。如果找到了更加合适的父节点，那么就把它们连接起来，并去除原来的连线（重布线）。
## 3. DWA
* **DWA原理**
DWA的原理主要是在速度空间（v,w）中采样多组速度，并模拟出这些速度在一定时间内的运动轨迹，并通过评价函数对这些轨迹进行评价，选取最优轨迹对应的速度驱动机器人运动。动态窗口法 DWA 的实现包含两个步骤：
  * 对机器人速度进行约束限制，形成动态窗口进行速度采样；
  * 根据速度采样点求出每一条轨迹的代价，选择代价最小的轨迹运行预测的时间。
代价函数由三个部分组成：
  * 速度参量：保证机器人尽量以最大的速度运行（用当前能运行的最大速度减去的当前运行的速度）
  * 障碍物参量：保证机器人尽量不要碰到障碍物（选取到最近的障碍的距离的倒数）
  * 方向参量：保证机器人向目标运动（用方向角和距离的组合）
* **调参**
  * 当小车转的角度始终过大的时候，考虑是否是以下几个因素：
    * 障碍的半径膨胀过大
    * 小车角速度范围太大，速度上限太大
    * 小车前面预测点距离当前位置较远
  * 当小车更偏向倒车而不是从侧面绕过障碍
    * 障碍物放置位置离小车太近
    * 小车给的角速度范围不够大